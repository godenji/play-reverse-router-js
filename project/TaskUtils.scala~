
trait TaskUtils {
	
	// extract sub project package names from main conf/routes
	def getModules = mainConf2Tuple.map(_._2)
	
	def routesFile(dir: String, module: String) = 
		dir+module+"/conf/"+module+".routes"
	
	/*
   * parses conf/routes file generating a List[Tuple2[String]] 
   * of sub project route List((uri, package name))
   * 
   * e.g. List((/account, account), (/admin, admin), (/, front))
   */
	lazy val mainConf2Tuple = {
		scala.io.Source.fromFile("conf/routes").
	  getLines.filter(_.startsWith("->")).
	  map( 
 	  	_.replaceAll("(->|.Routes)", "").
  	 	split("\b").map(_.replaceAll("\\s+", " "))
 		).
  	toList.flatten.
    map(_.trim.split(" ").toList).
 		map{
  		case(List(a,b))=> Map(a->b)
  	}.flatten
  }
 
	def print2File(f: java.io.File)(op: java.io.PrintWriter => Unit) {
		val p = new java.io.PrintWriter(f)
		try { op(p) } finally { p.close() }
	}
  
}
